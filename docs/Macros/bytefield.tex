% Create a bytefield block with labels at the top and bottom on the left side.
% Useful for address ranges.
%
% Parameters:
%  1. Top-left text
%  2. Bottom-left text
%  3. Height of block (in lines)
%  4. Block text
%
% Usage: \memsection{top}{bottom}{height}{text}
\newcommand{\memsection}[4]{
	\bytefieldsetup{bitheight=#3\baselineskip}
	\bitbox[]{8}{
		\texttt{#1}
		\\ \vspace{#3\baselineskip} \vspace{-2\baselineskip} \vspace{-#3pt}
		\texttt{#2}
	}
	\bitbox{16}{#4}
}

% A map function for faking 64bit formatting in the space of 32 bits.
%
% Usage: \begin{bytefield}[bitformatting=\fakesixtyfourbits,endianness=big]{32}
\newcommand{\fakesixtyfourbits}[1]{
	\tiny
	\ifnum#1=1234567890
		#1
	\else
		\count32=#1
		\advance\count32 by #1
		\the\count32
	\fi
}
